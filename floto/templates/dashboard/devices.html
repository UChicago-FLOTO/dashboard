{% extends 'default.html' %}

{% load static %}

{% block title %} Devices {% endblock %}

{% block content %}

<h3>Devices</h3>

<q-select
  label="Select fleets"
  filled
  v-model="selected_fleets.value"
  :options="fleets.value"
  :option-label="(fleet) => fleet.app_name"
  :option-value="(fleet) => fleet.id"
  emit-value
  map-options
  multiple
  use-chips
>
</q-select>


<q-table
    :columns="headers"
    :rows="devices.value.filter(d => selected_fleets.value.includes(d.belongs_to__application.__id))"
    :pagination="initialPagination"
    >
    <template v-slot:body-cell-action="props">
      <q-td :props="props">
        <a :href='`/dashboard/devices/${props.row.uuid}`'>
          <q-btn
            icon-right="visibility"
            no-caps
            flat
            dense
            @click="handleClick(props.row.uuid)"
          />
        </a>
      </q-td>
    </template>
  </q-table>


<div v-if="devices_loading && fleets_loading" class="center_of_screen">
  <q-circular-progress
    size="100px"
    indeterminate
    rounded
  ></q-circular-progress>
</div>

{% endblock %}

{% block scripts %}
<script src="{% static 'devices.js' %}"></script>
{% endblock %}
